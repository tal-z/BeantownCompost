{% extends 'dropoff_locations/base.html' %}
{% block content %}
        {{ map|safe }}
{% endblock content %}
{% block script %} 
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
crossorigin=""></script>
    <script>

        setTimeout(() => {
            
            let frame = document.getElementsByTagName('iframe')[0];
            //let map = frame.contentWindow.document.getElementById('{{ map_id }}');
            let map = frame.contentWindow['{{ map_id }}']
            let selectedLocation;
            let marker_count = 0;
            map.on('click', function(e) {
                selectedLocation = e.latlng;
                let marker = L.marker(selectedLocation).addTo(map);
            });
        }, 100);
    </script>
{% endblock script %}